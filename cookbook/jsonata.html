<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.64">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <link rel="icon" href="/favicon.ico"><title>JSONata Examples | node-red-contrib-home-assistant-websocket</title><meta name="description" content="Node-RED integration with Home Assistant through the WebSocket and HTTP API">
    <link rel="preload" href="/node-red-contrib-home-assistant-websocket/assets/style-310c18a4.css" as="style"><link rel="stylesheet" href="/node-red-contrib-home-assistant-websocket/assets/style-310c18a4.css">
    <link rel="modulepreload" href="/node-red-contrib-home-assistant-websocket/assets/app-84c1d8f6.js"><link rel="modulepreload" href="/node-red-contrib-home-assistant-websocket/assets/jsonata.html-791c02a2.js"><link rel="modulepreload" href="/node-red-contrib-home-assistant-websocket/assets/jsonata.html-36bd27de.js"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/FAQ.html-4f239f20.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/index.html-8209134d.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/index.html-0f7b4158.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/actionable-notifications-subflow-for-android.html-5e236e68.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/check-if-an-entity-was-turned-on-in-the-last-24-hours.html-451f88dd.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/expiration-date-monitor.html-27dc229d.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/get-state_changed-events-based-on-area.html-8e9d5ea0.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/holiday-lights-scheduler-and-demo-mode-for-wled.html-1403b12b.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/motion-triggered-light.html-2fd83efe.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/saving-and-restoring-states.html-f58adb73.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/starting-flow-after-home-assistant-restart.html-e477ab91.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/sun-events.html-ad2654f5.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/using-date-and-time-entities-to-trigger-flows.html-04956f6c.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/vacation-mode.html-29717f67.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/index.html-7974dc64.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/call-service.html-4ccbe47c.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/conditionals.html-6a6669c3.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/development.html-970befeb.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/diagnostics.html-f740dda1.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/documentation.html-d29ad9d4.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/first-automation.html-1c6140d8.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/jsonata.html-36ea3702.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/migration.html-3901854c.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/mustache-templates.html-7f78dce0.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/API.html-1010a88c.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/index.html-584e97e2.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/binary-sensor.html-63313354.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/button.html-72e42812.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/call-service.html-df655575.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/config-server.html-6d19cbf9.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/current-state.html-27525ee1.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/device-config.html-972d231e.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/device.html-a48371e9.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/entity-config.html-352765df.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/entity.html-0d547e37.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/events-all.html-2e710bfa.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/events-state.html-35317c75.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/fire-event.html-cb25bd39.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/get-entities.html-7e3569ac.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/get-history.html-448c9fb1.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/number.html-1a14dc3a.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/poll-state.html-80feb569.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/render-template.html-d5e55a24.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/select.html-bb316a7e.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/sensor.html-f91e76a7.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/sentence.html-b77a1fac.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/switch.html-4fa69740.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/tag.html-962d0df3.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/text.html-d5464564.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/time-entity.html-efc702e2.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/time.html-2ddd983b.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/trigger-state.html-8647461c.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/update-config.html-6fd660af.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/wait-until.html-5c3dcb48.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/webhook.html-c2d8bae1.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/zone.html-03652e46.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/index.html-52c05d65.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/index.html-6e6db7a8.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/exposed-nodes.html-f3e13cd3.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/404.html-60b35caa.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/FAQ.html-c5cfccde.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/index.html-0340f1d6.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/index.html-f03016ca.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/actionable-notifications-subflow-for-android.html-ab4243ec.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/check-if-an-entity-was-turned-on-in-the-last-24-hours.html-14ed9516.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/expiration-date-monitor.html-c7a77443.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/get-state_changed-events-based-on-area.html-bcf371b2.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/holiday-lights-scheduler-and-demo-mode-for-wled.html-e042c267.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/motion-triggered-light.html-a5d276aa.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/saving-and-restoring-states.html-10b993fa.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/starting-flow-after-home-assistant-restart.html-3cdc92b1.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/sun-events.html-bd3e2188.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/using-date-and-time-entities-to-trigger-flows.html-456933ea.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/vacation-mode.html-a37b0106.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/index.html-2cbdbe4c.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/call-service.html-c493de6b.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/conditionals.html-2e13e323.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/development.html-9afb102f.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/diagnostics.html-ef111d34.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/documentation.html-48b0fde5.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/first-automation.html-021f8afc.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/jsonata.html-f1d23560.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/migration.html-e3c0573d.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/mustache-templates.html-8c85bbc4.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/API.html-a2178096.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/index.html-cd097213.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/binary-sensor.html-aae75114.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/button.html-25bd9a68.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/call-service.html-2f221d66.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/config-server.html-b3c9bfba.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/current-state.html-706da91d.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/device-config.html-62ed985c.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/device.html-b94f6a76.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/entity-config.html-c345815c.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/entity.html-810b0652.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/events-all.html-552dbc86.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/events-state.html-179c7ff4.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/fire-event.html-21bc50ca.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/get-entities.html-abd59535.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/get-history.html-d41e6a1c.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/number.html-ab3857a9.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/poll-state.html-6d10084d.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/render-template.html-26664e8b.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/select.html-a4f4c411.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/sensor.html-1ed35e38.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/sentence.html-0f67d8fd.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/switch.html-7513839c.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/tag.html-a11d47c3.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/text.html-1a6c3ea9.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/time-entity.html-55ad6dac.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/time.html-9346b419.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/trigger-state.html-d521fa5b.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/update-config.html-9ad12ebb.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/wait-until.html-8fc8d4f4.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/webhook.html-45193ea9.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/zone.html-6fd6dd34.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/index.html-844d17b7.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/index.html-3f364098.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/exposed-nodes.html-bd2839c0.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/404.html-315a8184.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/DocsOnly-42881716.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/InfoPanelOnly-854eb97b.js" as="script"><link rel="prefetch" href="/node-red-contrib-home-assistant-websocket/assets/Scrubber-cdf90fea.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/node-red-contrib-home-assistant-websocket/" class=""><!----><span class="site-name">node-red-contrib-home-assistant-websocket</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><a href="/node-red-contrib-home-assistant-websocket/guide/" class="" aria-label="Guides"><!--[--><!--]--> Guides <!--[--><!--]--></a></div><div class="navbar-item"><a href="/node-red-contrib-home-assistant-websocket/node/" class="" aria-label="Nodes"><!--[--><!--]--> Nodes <!--[--><!--]--></a></div><div class="navbar-item"><a href="/node-red-contrib-home-assistant-websocket/FAQ.md" class="" aria-label="FAQ"><!--[--><!--]--> FAQ <!--[--><!--]--></a></div><div class="navbar-item"><a href="/node-red-contrib-home-assistant-websocket/cookbook/" class="router-link-active" aria-label="Cookbook"><!--[--><!--]--> Cookbook <!--[--><!--]--></a></div><div class="navbar-item"><a href="/node-red-contrib-home-assistant-websocket/scrubber/" class="" aria-label="Scrubber"><!--[--><!--]--> Scrubber <!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://github.com/zachowj/node-red-contrib-home-assistant-websocket/discussions" rel="noopener noreferrer" target="_blank" aria-label="Forums"><!--[--><!--]--> Forums <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://github.com/zachowj/node-red-contrib-home-assistant-websocket" rel="noopener noreferrer" target="_blank" aria-label="Github"><!--[--><!--]--> Github <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-color-mode-button" title="toggle color mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><form class="search-box" role="search"><input type="search" autocomplete="off" spellcheck="false" value><!----></form></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><a href="/node-red-contrib-home-assistant-websocket/guide/" class="" aria-label="Guides"><!--[--><!--]--> Guides <!--[--><!--]--></a></div><div class="navbar-item"><a href="/node-red-contrib-home-assistant-websocket/node/" class="" aria-label="Nodes"><!--[--><!--]--> Nodes <!--[--><!--]--></a></div><div class="navbar-item"><a href="/node-red-contrib-home-assistant-websocket/FAQ.md" class="" aria-label="FAQ"><!--[--><!--]--> FAQ <!--[--><!--]--></a></div><div class="navbar-item"><a href="/node-red-contrib-home-assistant-websocket/cookbook/" class="router-link-active" aria-label="Cookbook"><!--[--><!--]--> Cookbook <!--[--><!--]--></a></div><div class="navbar-item"><a href="/node-red-contrib-home-assistant-websocket/scrubber/" class="" aria-label="Scrubber"><!--[--><!--]--> Scrubber <!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://github.com/zachowj/node-red-contrib-home-assistant-websocket/discussions" rel="noopener noreferrer" target="_blank" aria-label="Forums"><!--[--><!--]--> Forums <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://github.com/zachowj/node-red-contrib-home-assistant-websocket" rel="noopener noreferrer" target="_blank" aria-label="Github"><!--[--><!--]--> Github <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p tabindex="0" class="sidebar-item sidebar-heading active">Cookbook <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/node-red-contrib-home-assistant-websocket/cookbook/jsonata.html" class="router-link-active router-link-exact-active router-link-active sidebar-item active" aria-label="JSONata Examples"><!--[--><!--]--> JSONata Examples <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/node-red-contrib-home-assistant-websocket/cookbook/jsonata.html#increase-lights-brightness-with-remote" class="router-link-active router-link-exact-active sidebar-item" aria-label="Increase lights brightness with remote"><!--[--><!--]--> Increase lights brightness with remote <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/node-red-contrib-home-assistant-websocket/cookbook/jsonata.html#notification-of-lights-left-on-when-leaving-home" class="router-link-active router-link-exact-active sidebar-item" aria-label="Notification of lights left on when leaving home"><!--[--><!--]--> Notification of lights left on when leaving home <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/node-red-contrib-home-assistant-websocket/cookbook/jsonata.html#or-conditional-for-the-events-state-node" class="router-link-active router-link-exact-active sidebar-item" aria-label="OR conditional for the events: state node"><!--[--><!--]--> OR conditional for the events: state node <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a href="/node-red-contrib-home-assistant-websocket/cookbook/motion-triggered-light.html" class="sidebar-item" aria-label="Motion Triggered Light"><!--[--><!--]--> Motion Triggered Light <!--[--><!--]--></a><!----></li><li><a href="/node-red-contrib-home-assistant-websocket/cookbook/saving-and-restoring-states.html" class="sidebar-item" aria-label="Saving and Restoring States"><!--[--><!--]--> Saving and Restoring States <!--[--><!--]--></a><!----></li><li><a href="/node-red-contrib-home-assistant-websocket/cookbook/get-state_changed-events-based-on-area.html" class="sidebar-item" aria-label="Get state_changed Events Based on Area"><!--[--><!--]--> Get state_changed Events Based on Area <!--[--><!--]--></a><!----></li><li><a href="/node-red-contrib-home-assistant-websocket/cookbook/sun-events.html" class="sidebar-item" aria-label="Turn Light On/Off with Sunset/Sunrise"><!--[--><!--]--> Turn Light On/Off with Sunset/Sunrise <!--[--><!--]--></a><!----></li><li><a href="/node-red-contrib-home-assistant-websocket/cookbook/vacation-mode.html" class="sidebar-item" aria-label="Vacation Mode"><!--[--><!--]--> Vacation Mode <!--[--><!--]--></a><!----></li><li><a href="/node-red-contrib-home-assistant-websocket/cookbook/expiration-date-monitor.html" class="sidebar-item" aria-label="Expiration Date Monitor with notification"><!--[--><!--]--> Expiration Date Monitor with notification <!--[--><!--]--></a><!----></li><li><a href="/node-red-contrib-home-assistant-websocket/cookbook/using-date-and-time-entities-to-trigger-flows.html" class="sidebar-item" aria-label="Using Date and Time entities to trigger flows"><!--[--><!--]--> Using Date and Time entities to trigger flows <!--[--><!--]--></a><!----></li><li><a href="/node-red-contrib-home-assistant-websocket/cookbook/check-if-an-entity-was-turned-on-in-the-last-24-hours.html" class="sidebar-item" aria-label="Check if an entity was a certain state in the last 24 hours"><!--[--><!--]--> Check if an entity was a certain state in the last 24 hours <!--[--><!--]--></a><!----></li><li><a href="/node-red-contrib-home-assistant-websocket/cookbook/starting-flow-after-home-assistant-restart.html" class="sidebar-item" aria-label="Starting a flow after a Home Assistant restart"><!--[--><!--]--> Starting a flow after a Home Assistant restart <!--[--><!--]--></a><!----></li><li><a href="/node-red-contrib-home-assistant-websocket/cookbook/holiday-lights-scheduler-and-demo-mode-for-wled.html" class="sidebar-item" aria-label="Holiday lights scheduler and demo mode for WLED"><!--[--><!--]--> Holiday lights scheduler and demo mode for WLED <!--[--><!--]--></a><!----></li><li><a href="/node-red-contrib-home-assistant-websocket/cookbook/actionable-notifications-subflow-for-android.html" class="sidebar-item" aria-label="Actionable Notifications Subflow for Android"><!--[--><!--]--> Actionable Notifications Subflow for Android <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><h1 id="jsonata-examples" tabindex="-1"><a class="header-anchor" href="#jsonata-examples" aria-hidden="true">#</a> JSONata Examples</h1><h2 id="increase-lights-brightness-with-remote" tabindex="-1"><a class="header-anchor" href="#increase-lights-brightness-with-remote" aria-hidden="true">#</a> Increase lights brightness with remote</h2><p>A remote with a button that when clicked it increases the brightness of a given light by an amount that is set from an input_number inside Home Assistant.</p><p><img src="data:image/png;base64,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" alt="screenshot"></p><div class="language-json" data-ext="json"><pre class="language-json"><code><span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token property">&quot;id&quot;</span><span class="token operator">:</span><span class="token string">&quot;86cbf80d.5a9cf8&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token string">&quot;api-call-service&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;z&quot;</span><span class="token operator">:</span><span class="token string">&quot;83fb2374.5839d&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;name&quot;</span><span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;version&quot;</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token property">&quot;service_domain&quot;</span><span class="token operator">:</span><span class="token string">&quot;light&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;service&quot;</span><span class="token operator">:</span><span class="token string">&quot;turn_on&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;entityId&quot;</span><span class="token operator">:</span><span class="token string">&quot;light.kitchen&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;data&quot;</span><span class="token operator">:</span><span class="token string">&quot;{\&quot;brightness\&quot;: $min([$entities(\&quot;light.kitchen\&quot;).attributes.brightness + $number($entities(\&quot;input_number.brightness\&quot;).state), 255])}&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;dataType&quot;</span><span class="token operator">:</span><span class="token string">&quot;jsonata&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;mergecontext&quot;</span><span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;output_location&quot;</span><span class="token operator">:</span><span class="token string">&quot;payload&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;output_location_type&quot;</span><span class="token operator">:</span><span class="token string">&quot;msg&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;mustacheAltTags&quot;</span><span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token property">&quot;x&quot;</span><span class="token operator">:</span><span class="token number">426</span><span class="token punctuation">,</span><span class="token property">&quot;y&quot;</span><span class="token operator">:</span><span class="token number">416</span><span class="token punctuation">,</span><span class="token property">&quot;wires&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token property">&quot;id&quot;</span><span class="token operator">:</span><span class="token string">&quot;8aad6643.9ee7a8&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token string">&quot;server-state-changed&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;z&quot;</span><span class="token operator">:</span><span class="token string">&quot;83fb2374.5839d&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;name&quot;</span><span class="token operator">:</span><span class="token string">&quot;Remote Button&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;version&quot;</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token property">&quot;entityidfilter&quot;</span><span class="token operator">:</span><span class="token string">&quot;sensor.button&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;entityidfiltertype&quot;</span><span class="token operator">:</span><span class="token string">&quot;exact&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;outputinitially&quot;</span><span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token property">&quot;state_type&quot;</span><span class="token operator">:</span><span class="token string">&quot;str&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;haltifstate&quot;</span><span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;halt_if_type&quot;</span><span class="token operator">:</span><span class="token string">&quot;str&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;halt_if_compare&quot;</span><span class="token operator">:</span><span class="token string">&quot;is&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;outputs&quot;</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token property">&quot;output_only_on_state_change&quot;</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token property">&quot;x&quot;</span><span class="token operator">:</span><span class="token number">224</span><span class="token punctuation">,</span><span class="token property">&quot;y&quot;</span><span class="token operator">:</span><span class="token number">416</span><span class="token punctuation">,</span><span class="token property">&quot;wires&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">&quot;86cbf80d.5a9cf8&quot;</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">]</span>
</code></pre></div><p>JSONata expression in the call-service node</p><div class="language-json" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;brightness&quot;</span><span class="token operator">:</span> $min(<span class="token punctuation">[</span>
    $entities(<span class="token string">&quot;light.kitchen&quot;</span>).attributes.brightness +
      $number($entities(<span class="token string">&quot;input_number.brightness&quot;</span>).state)<span class="token punctuation">,</span>
    <span class="token number">255</span>
  <span class="token punctuation">]</span>)
<span class="token punctuation">}</span>
</code></pre></div><h2 id="notification-of-lights-left-on-when-leaving-home" tabindex="-1"><a class="header-anchor" href="#notification-of-lights-left-on-when-leaving-home" aria-hidden="true">#</a> Notification of lights left on when leaving home</h2><p>Get notified when light or switch is left on when you leave. This a remake of Example #1 from this <a href="https://community.home-assistant.io/t/examples-for-using-the-new-get-entities-node/85777" target="_blank" rel="noopener noreferrer">post<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> showing how to manipulate entities and get the desired output.</p><p><img src="data:image/png;base64,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" alt="screenshot"></p><div class="language-json" data-ext="json"><pre class="language-json"><code><span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token property">&quot;id&quot;</span><span class="token operator">:</span><span class="token string">&quot;8420cd3d.051ac&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token string">&quot;trigger-state&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;z&quot;</span><span class="token operator">:</span><span class="token string">&quot;83fb2374.5839d&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;name&quot;</span><span class="token operator">:</span><span class="token string">&quot;Left Home&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;entityid&quot;</span><span class="token operator">:</span><span class="token string">&quot;device_tracker.jason&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;entityidfiltertype&quot;</span><span class="token operator">:</span><span class="token string">&quot;exact&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;debugenabled&quot;</span><span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token property">&quot;constraints&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token property">&quot;id&quot;</span><span class="token operator">:</span><span class="token string">&quot;9i2c9sz7d3e&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;targetType&quot;</span><span class="token operator">:</span><span class="token string">&quot;this_entity&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;targetValue&quot;</span><span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;propertyType&quot;</span><span class="token operator">:</span><span class="token string">&quot;previous_state&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;propertyValue&quot;</span><span class="token operator">:</span><span class="token string">&quot;old_state.state&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;comparatorType&quot;</span><span class="token operator">:</span><span class="token string">&quot;is&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;comparatorValueDatatype&quot;</span><span class="token operator">:</span><span class="token string">&quot;str&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;comparatorValue&quot;</span><span class="token operator">:</span><span class="token string">&quot;home&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token property">&quot;id&quot;</span><span class="token operator">:</span><span class="token string">&quot;3h3lghs8xsm&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;targetType&quot;</span><span class="token operator">:</span><span class="token string">&quot;this_entity&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;targetValue&quot;</span><span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;propertyType&quot;</span><span class="token operator">:</span><span class="token string">&quot;current_state&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;propertyValue&quot;</span><span class="token operator">:</span><span class="token string">&quot;new_state.state&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;comparatorType&quot;</span><span class="token operator">:</span><span class="token string">&quot;is&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;comparatorValueDatatype&quot;</span><span class="token operator">:</span><span class="token string">&quot;str&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;comparatorValue&quot;</span><span class="token operator">:</span><span class="token string">&quot;not_home&quot;</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token property">&quot;constraintsmustmatch&quot;</span><span class="token operator">:</span><span class="token string">&quot;all&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;outputs&quot;</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token property">&quot;customoutputs&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token property">&quot;outputinitially&quot;</span><span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token property">&quot;state_type&quot;</span><span class="token operator">:</span><span class="token string">&quot;str&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;x&quot;</span><span class="token operator">:</span><span class="token number">214</span><span class="token punctuation">,</span><span class="token property">&quot;y&quot;</span><span class="token operator">:</span><span class="token number">240</span><span class="token punctuation">,</span><span class="token property">&quot;wires&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">&quot;888034a3.b642c8&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token property">&quot;id&quot;</span><span class="token operator">:</span><span class="token string">&quot;888034a3.b642c8&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token string">&quot;api-call-service&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;z&quot;</span><span class="token operator">:</span><span class="token string">&quot;83fb2374.5839d&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;name&quot;</span><span class="token operator">:</span><span class="token string">&quot;Notify&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;version&quot;</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token property">&quot;service_domain&quot;</span><span class="token operator">:</span><span class="token string">&quot;notify&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;service&quot;</span><span class="token operator">:</span><span class="token string">&quot;android_jason&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;entityId&quot;</span><span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;data&quot;</span><span class="token operator">:</span><span class="token string">&quot;{\t   \&quot;message\&quot;: \&quot;The \&quot; &amp; $join($entities().*[state = \&quot;on\&quot; and entity_id ~&gt; /^light|^switch/].attributes.friendly_name, \&quot;, \&quot;) &amp; \&quot; are on.\&quot;,\t   \&quot;title\&quot;: \&quot;Left On\&quot;\t}&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;dataType&quot;</span><span class="token operator">:</span><span class="token string">&quot;jsonata&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;mergecontext&quot;</span><span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;output_location&quot;</span><span class="token operator">:</span><span class="token string">&quot;payload&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;output_location_type&quot;</span><span class="token operator">:</span><span class="token string">&quot;msg&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;mustacheAltTags&quot;</span><span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token property">&quot;x&quot;</span><span class="token operator">:</span><span class="token number">370</span><span class="token punctuation">,</span><span class="token property">&quot;y&quot;</span><span class="token operator">:</span><span class="token number">240</span><span class="token punctuation">,</span><span class="token property">&quot;wires&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">]</span>
</code></pre></div><p>This is the same as above but uses an event:state node and shows how to use the <code>$entity()</code> and <code>$prevEntity()</code> functions to compare states.</p><p><img src="data:image/png;base64,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" alt="screenshot"></p><div class="language-json" data-ext="json"><pre class="language-json"><code><span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token property">&quot;id&quot;</span><span class="token operator">:</span><span class="token string">&quot;cb25c8d7.881688&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token string">&quot;server-state-changed&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;z&quot;</span><span class="token operator">:</span><span class="token string">&quot;83fb2374.5839d&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;name&quot;</span><span class="token operator">:</span><span class="token string">&quot;Left Home&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;version&quot;</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token property">&quot;entityidfilter&quot;</span><span class="token operator">:</span><span class="token string">&quot;person.jason&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;entityidfiltertype&quot;</span><span class="token operator">:</span><span class="token string">&quot;exact&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;outputinitially&quot;</span><span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token property">&quot;state_type&quot;</span><span class="token operator">:</span><span class="token string">&quot;str&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;haltifstate&quot;</span><span class="token operator">:</span><span class="token string">&quot;$entity().state != $prevEntity().state&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;halt_if_type&quot;</span><span class="token operator">:</span><span class="token string">&quot;jsonata&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;halt_if_compare&quot;</span><span class="token operator">:</span><span class="token string">&quot;jsonata&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;outputs&quot;</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token property">&quot;output_only_on_state_change&quot;</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token property">&quot;x&quot;</span><span class="token operator">:</span><span class="token number">204</span><span class="token punctuation">,</span><span class="token property">&quot;y&quot;</span><span class="token operator">:</span><span class="token number">352</span><span class="token punctuation">,</span><span class="token property">&quot;wires&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">&quot;b48e8249.ad09f&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token property">&quot;id&quot;</span><span class="token operator">:</span><span class="token string">&quot;b48e8249.ad09f&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token string">&quot;api-call-service&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;z&quot;</span><span class="token operator">:</span><span class="token string">&quot;83fb2374.5839d&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;name&quot;</span><span class="token operator">:</span><span class="token string">&quot;Notify&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;version&quot;</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token property">&quot;service_domain&quot;</span><span class="token operator">:</span><span class="token string">&quot;notify&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;service&quot;</span><span class="token operator">:</span><span class="token string">&quot;android_jason&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;entityId&quot;</span><span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;data&quot;</span><span class="token operator">:</span><span class="token string">&quot;{\t   \&quot;message\&quot;: \&quot;The \&quot; &amp; $join($entities().*[state = \&quot;on\&quot; and entity_id ~&gt; /^light|^switch/].attributes.friendly_name, \&quot;, \&quot;) &amp; \&quot; are on.\&quot;,\t   \&quot;title\&quot;: \&quot;Left On\&quot;\t}&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;dataType&quot;</span><span class="token operator">:</span><span class="token string">&quot;jsonata&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;mergecontext&quot;</span><span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;output_location&quot;</span><span class="token operator">:</span><span class="token string">&quot;payload&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;output_location_type&quot;</span><span class="token operator">:</span><span class="token string">&quot;msg&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;mustacheAltTags&quot;</span><span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token property">&quot;x&quot;</span><span class="token operator">:</span><span class="token number">354</span><span class="token punctuation">,</span><span class="token property">&quot;y&quot;</span><span class="token operator">:</span><span class="token number">352</span><span class="token punctuation">,</span><span class="token property">&quot;wires&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">]</span>
</code></pre></div><p>Event-State Node: <code>$entity().state != $prevEntity().state</code></p><p>Call-Service Node:</p><div class="language-json" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
     <span class="token property">&quot;message&quot;</span><span class="token operator">:</span> <span class="token string">&quot;The &quot;</span> &amp; $join($entities().*<span class="token punctuation">[</span>state = <span class="token string">&quot;on&quot;</span> and entity_id ~&gt; /^light|^switch/<span class="token punctuation">]</span>.attributes.friendly_name<span class="token punctuation">,</span> <span class="token string">&quot;, &quot;</span>) &amp; <span class="token string">&quot; are on.&quot;</span><span class="token punctuation">,</span>
     <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Left On&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="or-conditional-for-the-events-state-node" tabindex="-1"><a class="header-anchor" href="#or-conditional-for-the-events-state-node" aria-hidden="true">#</a> OR conditional for the events: state node</h2><p>The trigger-state node is great if you have several conditions you want to check for but it doesn&#39;t allow you to use OR checks. Using a JSONata expression with an event:state node will allow you to fill this gap.</p><p>Motion sensor at the front door triggers and have a text to speech notification be sent if at least one person is home.</p><p><img src="data:image/png;base64,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" alt="screenshot"></p><div class="language-json" data-ext="json"><pre class="language-json"><code><span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token property">&quot;id&quot;</span><span class="token operator">:</span><span class="token string">&quot;114a7e82.282431&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token string">&quot;server-state-changed&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;z&quot;</span><span class="token operator">:</span><span class="token string">&quot;fac037bf.a42d78&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;name&quot;</span><span class="token operator">:</span><span class="token string">&quot;Motion Front Door&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;version&quot;</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token property">&quot;entityidfilter&quot;</span><span class="token operator">:</span><span class="token string">&quot;binary_sensor.front_door&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;entityidfiltertype&quot;</span><span class="token operator">:</span><span class="token string">&quot;exact&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;outputinitially&quot;</span><span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token property">&quot;state_type&quot;</span><span class="token operator">:</span><span class="token string">&quot;str&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;haltifstate&quot;</span><span class="token operator">:</span><span class="token string">&quot;$entity().state = \&quot;on\&quot; and (\t   $entities(\&quot;person.person1\&quot;).state = \&quot;home\&quot; or $entities(\&quot;person.person2\&quot;).state = \&quot;home\&quot;\t)&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;halt_if_type&quot;</span><span class="token operator">:</span><span class="token string">&quot;jsonata&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;halt_if_compare&quot;</span><span class="token operator">:</span><span class="token string">&quot;jsonata&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;outputs&quot;</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token property">&quot;output_only_on_state_change&quot;</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token property">&quot;x&quot;</span><span class="token operator">:</span><span class="token number">218</span><span class="token punctuation">,</span><span class="token property">&quot;y&quot;</span><span class="token operator">:</span><span class="token number">1040</span><span class="token punctuation">,</span><span class="token property">&quot;wires&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">&quot;8c84fdde.9770f&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token property">&quot;id&quot;</span><span class="token operator">:</span><span class="token string">&quot;8c84fdde.9770f&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token string">&quot;api-call-service&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;z&quot;</span><span class="token operator">:</span><span class="token string">&quot;fac037bf.a42d78&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;name&quot;</span><span class="token operator">:</span><span class="token string">&quot;TTS Motion&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;version&quot;</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token property">&quot;service_domain&quot;</span><span class="token operator">:</span><span class="token string">&quot;tts&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;service&quot;</span><span class="token operator">:</span><span class="token string">&quot;google_say&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;entityId&quot;</span><span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;data&quot;</span><span class="token operator">:</span><span class="token string">&quot;{\&quot;message\&quot;: \&quot;Movement at the front door.\&quot;}&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;dataType&quot;</span><span class="token operator">:</span><span class="token string">&quot;json&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;mergecontext&quot;</span><span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;output_location&quot;</span><span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;output_location_type&quot;</span><span class="token operator">:</span><span class="token string">&quot;none&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;mustacheAltTags&quot;</span><span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token property">&quot;x&quot;</span><span class="token operator">:</span><span class="token number">406</span><span class="token punctuation">,</span><span class="token property">&quot;y&quot;</span><span class="token operator">:</span><span class="token number">1040</span><span class="token punctuation">,</span><span class="token property">&quot;wires&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">]</span>
</code></pre></div><div class="language-json" data-ext="json"><pre class="language-json"><code>$entity().state = <span class="token string">&quot;on&quot;</span> and (
   $entities(<span class="token string">&quot;person.person1&quot;</span>).state = <span class="token string">&quot;home&quot;</span> or $entities(<span class="token string">&quot;person.person2&quot;</span>).state = <span class="token string">&quot;home&quot;</span>
)
</code></pre></div><p><strong>Also see:</strong></p><ul><li><a href="/node-red-contrib-home-assistant-websocket/guide/jsonata.html" class="">JSONata guide</a></li></ul></div><!--[--><!--]--></div><footer class="page-meta"><div class="meta-item edit-link"><a class="external-link meta-item-label" href="https://github.com/zachowj/node-red-contrib-home-assistant-websocket/edit/main/docs/cookbook/jsonata.md" rel="noopener noreferrer" target="_blank" aria-label="Help us improve this page!"><!--[--><!--]--> Help us improve this page! <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: 37859597+zachowj@users.noreply.github.com">Jason</span><!----><!--]--><!--]--></span></div></footer><nav class="page-nav"><p class="inner"><!----><span class="next"><a href="/node-red-contrib-home-assistant-websocket/cookbook/motion-triggered-light.html" class="" aria-label="Motion Triggered Light"><!--[--><!--]--> Motion Triggered Light <!--[--><!--]--></a></span></p></nav><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/node-red-contrib-home-assistant-websocket/assets/app-84c1d8f6.js" defer></script>
  </body>
</html>
